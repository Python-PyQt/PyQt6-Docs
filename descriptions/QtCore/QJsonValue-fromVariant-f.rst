.. sip:method-description::
    :status: todo
    :pysig: 98e6986adb6788a9c1859a407ab7e1bb
    :realsig: (const QVariant&)
    :digest: d81cbcb10515a1d2306be94ac26d80d7

Converts *variant* to a :sip:ref:`~PyQt6.QtCore.QJsonValue` and returns it.

The conversion will convert `QVariant <https://doc.qt.io/qt-6/qtcore-changes-qt6.html#qvariant>`_ types as follows:

+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Source type                                            | Destination type                                                                                                                                                                                                                                          |
+========================================================+===========================================================================================================================================================================================================================================================+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.Nullptr`      | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.Null`                                                                                                                                                                                                             |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.Bool`         | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.Bool`                                                                                                                                                                                                             |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.Int`          | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.Double`                                                                                                                                                                                                           |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.UInt`         |                                                                                                                                                                                                                                                           |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.LongLong`     |                                                                                                                                                                                                                                                           |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.ULongLong`    |                                                                                                                                                                                                                                                           |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.Float`        |                                                                                                                                                                                                                                                           |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.Double`       |                                                                                                                                                                                                                                                           |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QString`      | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.String`                                                                                                                                                                                                           |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QStringList`  | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.Array`                                                                                                                                                                                                            |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QVariantList` |                                                                                                                                                                                                                                                           |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QVariantMap`  | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.Object`                                                                                                                                                                                                           |
|                                                        |                                                                                                                                                                                                                                                           |
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QVariantHash` |                                                                                                                                                                                                                                                           |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QUrl`         | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.String`. The conversion will use :sip:ref:`~PyQt6.QtCore.QUrl.toString` with flag :sip:ref:`~PyQt6.QtCore.QUrl.ComponentFormattingOptions.FullyEncoded`, so as to ensure maximum compatibility in parsing the URL |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QUuid`        | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.String`. Since Qt 5.11, the resulting string will not include braces                                                                                                                                              |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QCborValue`   | Whichever type QCborValue::toJsonValue() returns.                                                                                                                                                                                                         |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QCborArray`   | :sip:ref:`~PyQt6.QtCore.QJsonValue.Type.Array`. See QCborValue::toJsonValue() for conversion restrictions.                                                                                                                                                |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| * :sip:ref:`~PyQt6.QtCore.QMetaType.Type.QCborMap`     | QJsonValue::Map. See QCborValue::toJsonValue() for conversion restrictions and the "stringification" of map keys.                                                                                                                                         |
+--------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Loss of information and other types
...................................

`QVariant <https://doc.qt.io/qt-6/qtcore-changes-qt6.html#qvariant>`_ can carry more information than is representable in JSON. If the `QVariant <https://doc.qt.io/qt-6/qtcore-changes-qt6.html#qvariant>`_ is not one of the types above, the conversion is not guaranteed and is subject to change in future versions of Qt, as the UUID one did. Code should strive not to use any other types than those listed above.

If :sip:ref:`~PyQt6.QtCore.QVariant.isNull` returns true, a null :sip:ref:`~PyQt6.QtCore.QJsonValue` is returned or inserted into the list or object, regardless of the type carried by `QVariant <https://doc.qt.io/qt-6/qtcore-changes-qt6.html#qvariant>`_. Note the behavior change in Qt 6.0 affecting :sip:ref:`~PyQt6.QtCore.QVariant.isNull` also affects this function.

A floating point value that is either an infinity or NaN will be converted to a null JSON value. Since Qt 6.0, :sip:ref:`~PyQt6.QtCore.QJsonValue` can store the full precision of any 64-bit signed integer without loss, but in previous versions values outside the range of Â±2^53 may lose precision. Unsigned 64-bit values greater than or equal to 2^63 will either lose precision or alias to negative values, so :sip:ref:`~PyQt6.QtCore.QMetaType.Type.ULongLong` should be avoided.

For other types not listed above, a conversion to string will be attempted, usually but not always by calling QVariant::toString(). If the conversion fails the value is replaced by a null JSON value. Note that QVariant::toString() is also lossy for the majority of types. For example, if the passed `QVariant <https://doc.qt.io/qt-6/qtcore-changes-qt6.html#qvariant>`_ is representing raw byte array data, it is recommended to pre-encode it to `Base64 <https://www.ietf.org/rfc/rfc4648.txt>`_ (or another lossless encoding), otherwise a lossy conversion using QString::fromUtf8() will be used.

Please note that the conversions via QVariant::toString() are subject to change at any time. Both `QVariant <https://doc.qt.io/qt-6/qtcore-changes-qt6.html#qvariant>`_ and :sip:ref:`~PyQt6.QtCore.QJsonValue` may be extended in the future to support more types, which will result in a change in how this function performs conversions.

.. seealso:: :sip:ref:`~PyQt6.QtCore.QJsonValue.toVariant`, QCborValue::fromVariant().
