.. sip:class-description::
    :status: todo
    :brief: Scalable icons in different modes and states
    :digest: b6cbaf0370a6e03f7d4ea1ed57d24ad8

The :sip:ref:`~PyQt6.QtGui.QIcon` class provides scalable icons in different modes and states.

A :sip:ref:`~PyQt6.QtGui.QIcon` can generate smaller, larger, active, and disabled pixmaps from the set of pixmaps it is given. Such pixmaps are used by Qt UI components to show an icon representing a particular action.

.. _qicon-creating-an-icon-from-image-files:

Creating an icon from image files
---------------------------------

The simplest way to construct a :sip:ref:`~PyQt6.QtGui.QIcon` is to create one from one or several image files or resources. For example:

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.py
    :lines: 68-69

:sip:ref:`~PyQt6.QtGui.QIcon` can store several images for different states, and Qt will select the image that is the closest match for the action's current state.

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.py

Qt will generate the required icon styles and sizes when needed, e.g. the pixmap for the :sip:ref:`~PyQt6.QtGui.QIcon.Mode.Disabled` state might be generated by graying out one of the provided pixmaps.

To clear the icon, simply set a null icon in its place:

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.py
    :lines: 74-74

Use the :sip:ref:`~PyQt6.QtGui.QImageReader.supportedImageFormats` and :sip:ref:`~PyQt6.QtGui.QImageWriter.supportedImageFormats` functions to retrieve a complete list of the supported file formats.

.. _qicon-creating-an-icon-from-a-theme-or-icon-library:

Creating an icon from a theme or icon library
---------------------------------------------

The most convenient way to construct an icon is by using the :sip:ref:`~PyQt6.QtGui.QIcon.fromTheme` factory function. Qt implements access to the native icon library on platforms that support the `Freedesktop Icon Theme Specification <https://doc.qt.io/qt-6/https://standards.freedesktop.org/icon-theme-spec/icon-theme-spec-latest.html>`_.

Applications can use the same theming specification to provide their own icon library. See below for an example theme description and the corresponding directory structure for the image files.

Since Qt 6.7, Qt also provides access to the native icon library on macOS, iOS, and Windows 10 and 11. On Android, Qt can access icons from the Material design system as long as the `MaterialIcons-Regular <https://github.com/google/material-design-icons/tree/master/font>`_ font is available on the system, or bundled as a resource at ``:/qt-project.org/icons/MaterialIcons-Regular.ttf`` with the application.

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.py

Since Qt 6.9, Qt can generate icons from named glyphs in an available icon font. Set the :sip:ref:`~PyQt6.QtGui.QIcon.themeName` to the family name of the font, and use :sip:ref:`~PyQt6.QtGui.QIcon.fromTheme` with the name of the glyph.

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.py

The icon font can be installed on the system, or bundled as an :sip:ref:`~PyQt6.QtGui.QFontDatabase.addApplicationFont`.

.. _qicon-icon-engines:

Icon Engines
------------

Internally, :sip:ref:`~PyQt6.QtGui.QIcon` instantiates an :sip:ref:`~PyQt6.QtGui.QIconEngine` backend to handle and render the icon images. The type of icon engine is determined by the first file or pixmap or theme added to a :sip:ref:`~PyQt6.QtGui.QIcon` object. Additional files or pixmaps will then be handled by the same engine.

Icon engines differ in the way they handle and render icons. The default pixmap-based engine only deals with fixed images, while the :sip:ref:`~PyQt6.QtSvg` module provides an icon engine that can re-render the provided vector graphics files at the requested size for better quality. The theme icon engines will typically only provide images from native platform icon library, and ignore any added files or pixmaps.

In addition, it is possible to provide custom icon engines. This allows applications to customize every aspect of generated icons. With QIconEnginePlugin it is possible to register different icon engines for different file suffixes, making it possible for third parties to provide additional icon engines to those included with Qt.

.. _qicon-using-qicon-in-the-user-interface:

Using QIcon in the User Interface
---------------------------------

If you write your own widgets that have an option to set a small pixmap, consider allowing a :sip:ref:`~PyQt6.QtGui.QIcon` to be set for that pixmap. The Qt class :sip:ref:`~PyQt6.QtWidgets.QToolButton` is an example of such a widget.

Provide a method to set a :sip:ref:`~PyQt6.QtGui.QIcon`, and paint the :sip:ref:`~PyQt6.QtGui.QIcon` with :sip:ref:`~PyQt6.QtGui.QIcon.paint`, choosing the appropriate parameters based on the current state of your widget. For example:

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.py
    :lines: 81-89

When you retrieve a pixmap using pixmap(\ :sip:ref:`~PyQt6.QtCore.QSize`, Mode, State), and no pixmap for this given size, mode and state has been added with :sip:ref:`~PyQt6.QtGui.QIcon.addFile` or :sip:ref:`~PyQt6.QtGui.QIcon.addPixmap`, then :sip:ref:`~PyQt6.QtGui.QIcon` will generate one on the fly. This pixmap generation happens in a :sip:ref:`~PyQt6.QtGui.QIconEngine`. The default engine scales pixmaps down if required, but never up, and it uses the current style to calculate a disabled appearance.

You might also make use of the ``Active`` mode, perhaps making your widget ``Active`` when the mouse is over the widget (see :sip:ref:`~PyQt6.QtWidgets.QWidget.enterEvent`), while the mouse is pressed pending the release that will activate the function, or when it is the currently selected item. If the widget can be toggled, the "On" mode might be used to draw a different icon.

QIcons generated from the native icon library, or from an icon font, use the same glyph for both the ``On`` and ``Off`` states of the icon. Applications can change the icon depending on the state of the respective UI control or action. In a Qt Quick application, this can be done with a binding.

.. literalinclude:: ../../../snippets/qtbase-src-gui-doc-snippets-code-src_gui_image_qicon.qml
    :lines: 11-15

.. image:: ../../../images/icon.png

**Note:** :sip:ref:`~PyQt6.QtGui.QIcon` needs a :sip:ref:`~PyQt6.QtGui.QGuiApplication` instance before the icon is created.

.. _qicon-high-dpi-icons:

High DPI Icons
--------------

Icons that are provided by the native icon library, or generated from the glyph in an icon font, are usually based on vector graphics, and will automatically be rendered in the appropriate resolution.

When providing your own image files via :sip:ref:`~PyQt6.QtGui.QIcon.addFile`, then :sip:ref:`~PyQt6.QtGui.QIcon` will use Qt's "@nx" high DPI syntax. This is useful if you have your own custom directory structure and do not use follow `Freedesktop Icon Theme Specification <https://doc.qt.io/qt-6/https://standards.freedesktop.org/icon-theme-spec/icon-theme-spec-latest.html>`_.

When providing an application theme, then you need to follow the Icon Theme Specification to specify which files to use for different resolutions. To make :sip:ref:`~PyQt6.QtGui.QIcon` use the high DPI version of an image, add an additional entry to the appropriate ``index.theme`` file:

::

    [Icon Theme]
    Name=Test
    Comment=Test Theme

    Directories=32x32/actions,32x32@2/actions

    [32x32/actions]
    Size=32
    Context=Actions
    Type=Fixed

    # High DPI version of the entry above.
    [32x32@2/actions]
    Size=32
    Scale=2
    Type=Fixed

Your icon theme directory would then look something like this:

::

    ├── 32x32
    │   └── actions
    │       └── appointment-new.png
    ├── 32x32@2
    │   └── actions
    │       └── appointment-new.png
    └── index.theme
